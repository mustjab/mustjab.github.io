<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Browser Translation API Demo</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="../../icon.png">
</head>

<body>
  <div class="container">
    <header>
      <h1>Browser Translation API Demo</h1>
      <p class="subtitle">Testing browser's built-in on-device translation capabilities</p>
      <div class="api-status" id="apiStatus">
        <span class="status-indicator" id="statusIndicator"></span>
        <span id="statusText">Checking API availability...</span>
      </div>
    </header>

    <main>
      <!-- Translator Initialization Section -->
      <section class="card">
        <h2>Translator Initialization</h2>
        <div class="form-row">
          <div class="form-group">
            <label for="sourceLanguage">Source Language:</label>
            <div class="searchable-select-container">
              <input type="text" id="sourceLanguageSearch" class="searchable-select-input"
                placeholder="Type to search languages..." autocomplete="off">
              <div class="searchable-select-dropdown" id="sourceLanguageDropdown" style="display: none;">
                <!-- Languages will be populated by JavaScript -->
              </div>
              <input type="hidden" id="sourceLanguage" value="en">
            </div>
          </div>
          <div class="swap-container">
            <button type="button" id="swapLanguages" class="btn-swap" title="Swap source and target languages">
              â‡„
            </button>
          </div>
          <div class="form-group">
            <label for="targetLanguage">Target Language:</label>
            <div class="searchable-select-container">
              <input type="text" id="targetLanguageSearch" class="searchable-select-input"
                placeholder="Type to search languages..." autocomplete="off">
              <div class="searchable-select-dropdown" id="targetLanguageDropdown" style="display: none;">
                <!-- Languages will be populated by JavaScript -->
              </div>
              <input type="hidden" id="targetLanguage" value="zh-CN">
            </div>
          </div>
        </div>
        <button id="initializeTranslator" class="btn btn-primary" disabled>Initialize Translator</button>
        <div class="progress-container" id="downloadProgress" style="display: none;">
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
          <div class="progress-text" id="progressText">0%</div>
        </div>
        <div id="initResult" class="result-box"></div>
      </section><!-- Translation Test Section -->
      <section class="card">
        <h2>Translation Test</h2>
        <div class="info-banner">
          <h3>ðŸ”„ Compare Translation Methods</h3>
          <p><code>translate()</code> returns complete translation. <code>translateStreaming()</code> can stream
            sentence-by-sentence (enable with <code>--enable-features=TranslateStreamingBySentence</code>).</p>
        </div>
        <div class="form-group">
          <label for="inputText">Text to Translate:</label>
          <textarea id="inputText" rows="6"
            placeholder="Enter text to translate...">Artificial intelligence and machine learning technologies are revolutionizing how we approach language translation and natural language processing. These advanced systems can now understand context, idioms, and cultural nuances that were previously challenging for automated translation systems. The integration of neural networks has significantly improved translation quality across multiple languages.</textarea>
        </div>
        <div class="button-group">
          <button id="translateSingle" class="btn btn-primary" disabled>Translate</button>
          <button id="translateStreaming" class="btn btn-secondary" disabled>Translate with Streaming</button>
        </div>

        <!-- Performance Metrics -->
        <div class="single-stats">
          <div class="single-stat-item">
            <label>Characters:</label>
            <div id="singleChars">0</div>
          </div>
          <div class="single-stat-item">
            <label>Time (ms):</label>
            <div id="singleTime">0</div>
          </div>
          <div class="single-stat-item">
            <label>Throughput:</label>
            <div id="singleThroughput">0 chars/sec</div>
          </div>
          <div class="single-stat-item">
            <label>Chunks:</label>
            <div id="streamingChunks">-</div>
          </div>
          <div class="single-stat-item">
            <label>Chunks/Sec:</label>
            <div id="chunksPerSec">-</div>
          </div>
        </div>

        <div class="translation-results">
          <div class="result-item">
            <div class="result-header">
              <label>Translated Text:</label>
              <button id="copyTranslated" class="btn-copy" title="Copy to clipboard" style="display: none;">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M5.5 4.5H3.5C3.23478 4.5 2.98043 4.60536 2.79289 4.79289C2.60536 4.98043 2.5 5.23478 2.5 5.5V12.5C2.5 12.7652 2.60536 13.0196 2.79289 13.2071C2.98043 13.3946 3.23478 13.5 3.5 13.5H10.5C10.7652 13.5 11.0196 13.3946 11.2071 13.2071C11.3946 13.0196 11.5 12.7652 11.5 12.5V10.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                  <path d="M13.5 2.5H6.5C6.23478 2.5 5.98043 2.60536 5.79289 2.79289C5.60536 2.98043 5.5 3.23478 5.5 3.5V10.5C5.5 10.7652 5.60536 11.0196 5.79289 11.2071C5.98043 11.3946 6.23478 11.5 6.5 11.5H13.5C13.7652 11.5 14.0196 11.3946 14.2071 11.2071C14.3946 11.0196 14.5 10.7652 14.5 10.5V3.5C14.5 3.23478 14.3946 2.98043 14.2071 2.79289C14.0196 2.60536 13.7652 2.5 13.5 2.5Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="copy-text">Copy</span>
              </button>
            </div>
            <div id="translatedText" class="text-output"></div>
          </div>
        </div>
      </section><!-- Batch Translation Section -->
      <section class="card">
        <h2>Batch Translation Benchmark</h2>
        <div class="info-banner">
          <h3>ðŸ“Š Standardized Multilingual Benchmark Tests</h3>
          <p>This benchmark uses a fixed set of 15 standardized texts to ensure consistent and comparable results across
            different multilingual models, language pairs, browsers and sessions.</p>
        </div>
        <div class="benchmark-info">
          <div class="benchmark-stats">
            <div class="stat-preview">
              <label>Test Sentences:</label>
              <div>15 standardized texts</div>
            </div>
            <div class="stat-preview">
              <label>Total Characters:</label>
              <div id="totalChars">1,847</div>
            </div>
            <div class="stat-preview">
              <label>Avg. Sentence Length:</label>
              <div id="avgLength">123 chars</div>
            </div>
          </div>
        </div>
        <button id="runBatchTest" class="btn btn-primary" disabled>Run Multilingual Benchmark (15 texts)</button>
        <div class="batch-results">
          <div class="stats-grid">
            <div class="stat-item">
              <label>Total Translations:</label>
              <div id="totalTranslations">0</div>
            </div>
            <div class="stat-item">
              <label>Average Time (ms):</label>
              <div id="averageTime">0</div>
            </div>
            <div class="stat-item">
              <label>Total Time (ms):</label>
              <div id="totalTime">0</div>
            </div>
            <div class="stat-item">
              <label>Throughput (chars/sec):</label>
              <div id="throughput">0</div>
            </div>
          </div>
          <div class="batch-controls">
            <button id="exportResults" class="btn btn-secondary" disabled>Export CSV</button>
            <button id="clearResults" class="btn btn-secondary">Clear Results</button>
          </div>
          <div id="batchResultsTable"></div>
        </div>
      </section>
    </main>

    <footer>
      <p>Built with browser's Translation API | <a href="https://developer.chrome.com/docs/ai/translator-api"
          target="_blank">API Documentation</a></p>
    </footer>
  </div>

  <script src="script.js"></script>
</body>

</html>